(window.webpackJsonpReactComponents=window.webpackJsonpReactComponents||[]).push([[0],{202:function(e,t,a){"use strict";var r=a(190),i=a.n(r),s=a(12),c=a.n(s),n=a(71),l=a.n(n),o=a(72),d=a(73);t.a=(e,t)=>{const a=a=>{const r={...a},{wrappedActivityData:n,activityType:l,activityId:o}=a;delete r.wrappedActivityData,Object(s.useEffect)(()=>{t({activityType:l,activityId:o})},[]);let d=n||{};return n?c.a.createElement(e,i()({},r,d)):null};a.propTypes={wrappedActivityData:l.a.shape({screenId:l.a.number,activityId:l.a.string,activityType:l.a.string})};return Object(o.connect)((e,t)=>({wrappedActivityData:Object(d.a)(e,t)}),null)(a)}},203:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c}));var r=a(18);const i={},s=({activityType:e,reducer:t,saga:a})=>{t&&Object(r.d)(t),a&&Object(r.e)(a),i[e]=!0},c=e=>Boolean(i[e])},204:function(e,t,a){"use strict";var r=a(190),i=a.n(r),s=a(12),c=a.n(s),n=a(71),l=a.n(n),o=a(84);const d=({correct:e,wrong:t,revealed:a,classNames:r,tooltip:s,Component:n=o.a,...l})=>{const d=c.a.createElement(n,i()({correct:e,wrong:t,revealed:a,classNames:r},l));return s?c.a.createElement(o.c,{tooltip:s},d):d};d.propTypes={correct:l.a.bool,wrong:l.a.bool,revealed:l.a.bool,classNames:l.a.array},t.a=d},272:function(e,t){},274:function(e,t){},334:function(e,t,a){"use strict";a.r(t);var r=a(12),i=a.n(r),s=a(71),c=a.n(s),n=a(72),l=a(202),o=a(14),d=a(10),u=a(203),y=a(3),p=a(2),v=a(53),b=a(7),m=a.n(b),f=a(6),I=a(45);const C=(e,t)=>Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))+1,O=(e,t)=>{const a=((e,t)=>({dx:Math.sign(t.x-e.x),dy:Math.sign(t.y-e.y)}))(e,t),r=C(e,t);let{x:i,y:s}=e;const c=[];return Array.from({length:r}).forEach(()=>{c.push({x:i,y:s}),i+=a.dx,s+=a.dy}),c},g=(e,t)=>e.filter(({x0:e,y0:a,x1:r,y1:i})=>((e,t,a)=>O(t,a).some(({x:t,y:a})=>e.x===t&&e.y===a))(t,{x:e,y:a},{x:r,y:i})),w=(e,t)=>C({x:e.x0,y:e.y0},t)-1,h=(e,t)=>{const a=w(e,t);return 0===a?"first":a===C({x:e.x0,y:e.y0},{x:e.x1,y:e.y1})-1?"last":"middle"},D=(e,t)=>`${e}_${t}`,j=(e,t)=>`${D(e.x,e.y)}_${D(t.x,t.y)}`,E=e=>e.iccrossword_cells_uiData,x=(e,t)=>t.activityId,T=(e,t)=>t.id,S=Object(f.a)([E],e=>{if(e)return Object.values(e)}),R=m()([S,x],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(x,{selectorCreator:f.a}),A=m()([E,T],(e,t)=>{if(e&&t)return e[t]})(T),U=m()([A],e=>{if(e)return e.dataType})(T),k=m()([R],e=>{if(e)return e.filter(({dataType:e})=>"solution"===e)})(x,{selectorCreator:f.a}),P=m()([R],e=>{if(e)return e.filter(({enabled:e})=>e)})(x,{selectorCreator:f.a}),_=e=>e.iccrossword_cells_itemData,N=(e,t)=>t.activityId,q=(e,t)=>t.id,B=Object(f.a)([_],e=>{if(e)return Object.values(e)}),L=m()([B,N],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(N,{selectorCreator:f.a}),$=m()([_,q],(e,t)=>{if(e&&t)return e[t]})(q),z=(m()([L,k],(e,t)=>{if(!e||!t)return;const a=t.map(({id:e})=>e);return e.filter(e=>a.includes(e.id))})(N,{selectorCreator:f.a}),m()([L,P],(e,t)=>{if(!e||!t)return;const a=t.map(({id:e})=>e);return e.filter(e=>a.includes(e.id))})(N,{selectorCreator:f.a})),F=m()([I.getActivityItemData,()=>!1],(e,t)=>{if(!e||null==t)return;if(!t)return[];const a=[];return e.forEach(e=>{const t={x:e.x0,y:e.y0,type:"clue",words:[e.id]};"v"===e.align?t.y--:t.x--;a.find(e=>e.x===t.x&&e.y===t.y)||a.push(t)}),a})(N,{selectorCreator:f.a}),V=m()([L,F,(e,t)=>t.index],(e,t,a)=>{if(e&&null!=a&&t)return e.filter(e=>e.y===a).map(e=>{const a=t.find(t=>t.x===e.x&&t.y===e.y);return{...e,...a}})})((e,t)=>`${t.activityId}${t.index}`,{selectorCreator:f.a}),M=m()([$,I.getActivityItemData],(e,t)=>{if(e&&t)return t.filter(t=>e.words.includes(t.id))})(q,{selectorCreator:f.a}),G=m()([I.getActivityItemData,z],(e,t)=>{if(!e||!t)return;const a=[...new Set(t.flatMap(({words:e})=>e))];return e.filter(e=>a.includes(e.id))})(N,{selectorCreator:f.a}),H=(m()([(e,t)=>{const{x0:a,y0:r,x1:i,y1:s}=t;return O({x:a,y:r},{x:i,y:s})},L],(e,t)=>{if(e&&t)return e.map(({x:e,y:a})=>t.find(t=>t.x===e&&t.y===a))})(q,{selectorCreator:f.a}),m()([B,(e,t)=>t.cells],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})((e,t)=>JSON.stringify([...t.cells||[]].sort()),{selectorCreator:f.a}));var W=a(22);const K=Object(y.c)({name:"iccrossword_cell_itemData",initialState:{},reducers:{addCellsItemData:(e,t)=>({...e,...t.payload.data}),clearCellsItemData:(e,{payload:{data:t}})=>Object.keys(e).reduce((a,r)=>(t.includes(r)||(a[r]=e[r]),a),{})}}),J=K.reducer,Y=K.actions,Q=Object(y.c)({name:"iccrossword_cell_userData",initialState:{},reducers:{setCellsUserData:(e,t)=>({...e,...t.payload.data}),clearCellsUserData:(e,t)=>{const a=t.payload.data;return Object.keys(e).reduce((t,r)=>(a.includes(r)||(t[r]=e[r]),t),{})}}}),X=Q.reducer,Z=Q.actions,ee=Object(y.c)({name:"iccrossword_cell_solutionData",initialState:{},reducers:{addCellsSolutionData:(e,t)=>({...e,...t.payload.data}),clearCellsSolutionData:(e,{payload:{data:t}})=>Object.keys(e).reduce((a,r)=>(t.includes(r)||(a[r]=e[r]),a),{})}}),te=ee.reducer,ae=ee.actions;var re=a(58);const ie=Object(y.c)({name:"iccrossword_cell_uiData",initialState:{},reducers:{setCellUIData:(e,t)=>{t.payload.data.forEach(t=>{e[t.id]={...e[t.id],...t}})},clearCellUIData:(e,t)=>{const a=t.payload.data;return Object.keys(e).reduce((t,r)=>(a.includes(r)||(t[r]=e[r]),t),{})}},extraReducers:{[Y.addCellsItemData.type]:(e,{payload:{data:t}})=>({...e,...Object.values(t).reduce((e,t)=>(e[t.id]={id:t.id,activityId:t.activityId,enabled:re.a.enabled,dataType:re.a.dataType},e),{})})}}),se=ie.reducer,ce=ie.actions;var ne={iccrossword_cells_itemData:J,iccrossword_cells_userData:X,iccrossword_cells_solutionData:te,iccrossword_cells_uiData:se};const le={...Y,...Z,...ae,...ce};var oe=a(23);const de=Object(y.b)("iccrosswordSetCellData"),ue=Object(y.b)("iccrosswordClearCellData");function*ye(e){try{const{cell:t,words:a,userData:r}=yield*ve(e.payload),i=a.map(a=>{const i=r.find(e=>e.id===a.id);let s=a.cells.indexOf(t.id),c=be(e.payload.value,null==i?void 0:i.value,s,a.cells.length);return{id:a.id,activityId:t.activityId,value:c}});yield Object(p.b)(le.setCellsUserData({data:Object(v.b)([e.payload]).entities.userData})),yield Object(p.b)(oe.a.setUserData({activityType:"iccrossword",data:Object(v.b)(i).entities.userData})),Object(o.c)(d.b.VALUE_CHANGE,{type:"iccrossword",id:e.payload.activityId})}catch(e){throw Error(e.message)}}function*pe(e){try{const{cell:t,words:a,userData:r}=yield*ve(e.payload),i=[],s=[];a.forEach(e=>{const a=r.find(t=>t.id===e.id);let c,n=e.cells.indexOf(t.id);c=be(" ",null==a?void 0:a.value,n,e.cells.length),c.trim()?i.push({id:e.id,value:c}):s.push(e.id)}),yield Object(p.b)(le.clearCellsUserData({data:[t.id]})),i.length&&(yield Object(p.b)(oe.a.setUserData({activityId:t.activityId,activityType:"iccrossword",data:Object(v.b)(i).entities.userData}))),s.length&&(yield Object(p.b)(oe.a.clearUserData({activityId:t.activityId,activityType:"iccrossword",data:s}))),Object(o.c)(d.b.VALUE_CHANGE,{type:"iccrossword",id:e.payload.activityId})}catch(e){throw Error(e.message)}}function*ve(e){const t=yield Object(p.c)($,e);return{cell:t,words:yield Object(p.c)(M,t),userData:yield Object(p.c)(W.getUserDataByIds,{activityId:t.activityId,ids:t.words})}}const be=(e,t,a,r)=>{if(t)return`${t.substr(0,a)}${e}${t.substr(a+1,r-a)}`;{let t=new Array(r).fill(" ");return t[a]=e,t.join("")}};var me={watchSetCellUserData:function*(){yield Object(p.d)(de.type,ye)},watchClearCellUserData:function*(){yield Object(p.d)(ue.type,pe)}};const fe={setCellUserData:de,clearCellUserData:ue};var Ie=a(32),Ce=a(68),Oe=a(63),ge=a(36),we=a(9),he=a(76);const De=new we.b.Entity("cellsItemData",{words:he.a}),je=[De];var Ee=a(92);function*xe(e){const{id:t,itemData:a,solutionData:r,metadata:i}=e,{cells:s,...c}=i,n=a.map(e=>{const{x0:a,y0:r,x1:i,y1:s}=e,c=j({x:a,y:r},{x:i,y:s}),n=O({x:a,y:r},{x:i,y:s}).map(e=>`${t}_${D(e.x,e.y)}`);return{id:`${t}_${c}`,...e,activityId:t,cells:n}}),l={};let o=1;n.forEach(e=>{const t=e.cells[0];l[t]=l[t]||o++,e.label=l[t]});const d=r.map(e=>{const{x0:a,y0:r,x1:i,y1:s,word:c}=e,n=j({x:a,y:r},{x:i,y:s});return{id:`${t}_${n}`,value:c,activityId:t}}),u=s.map(e=>{const a=g(n,e),r=D(e.x,e.y),i=`${t}_${r}`;return{id:i,...e,words:a,label:l[i],activityId:t}}),y=u.filter(({words:e})=>e.length).map(e=>{const a=e.words[0],r=d.find(({id:e})=>e===a.id).value.charAt(w(a,e)),i=D(e.x,e.y);return{id:`${t}_${i}`,value:r,activityId:t}}),p=(v=u,Object(we.a)(v,je)).entities.cellsItemData;var v;const b=Object(Ee.b)(y).entities.solutionData,m=yield Ie.b.addActivities({...e,itemData:n,solutionData:d,metadata:c}),f=le.addCellsItemData({data:p}),I=le.addCellsSolutionData({data:b});return m.concat([f,I])}function*Te(e){const{id:t}=e,a=(yield Object(p.c)(L,{activityId:t})).map(({id:e})=>e),r=yield Ie.b.removeActivities(e),i=le.clearCellsItemData({data:a}),s=le.clearCellsSolutionData({data:a}),c=le.clearCellsUserData({data:a}),n=le.clearCellUIData({data:a});return r.concat([i,s,c,n])}var Se=a(25),Re=a(56),Ae=a(93);function*Ue(e){const{activityId:t}=e,a=yield Object(p.c)(I.getItemDataByIds,e),r=yield Object(p.c)(Ae.a,e),i=yield Object(p.c)(W.getUserDataByIds,e);let s=yield Object(p.c)(k,e);if(s=s.map(e=>e.id),a.length){const e=a.map(e=>{var a,c;const n=null===(a=i.find(t=>t.id===e.id))||void 0===a?void 0:a.value,l=null===(c=r.find(t=>t.id===e.id))||void 0===c?void 0:c.value;let o=n||new Array(l.length).fill(" ").join("");return e.cells.forEach((e,t)=>{s.includes(e)&&(o=`${o.slice(0,t)}${l.charAt(t)}${o.slice(t+1,o.length)}`)}),{id:e.id,activityId:t,correct:Boolean(n&&o.toLowerCase()===l.toLowerCase()),filled:Boolean(n&&-1===o.indexOf(" "))}});return[Se.a.addValidation({activityType:"iccrossword",data:Object(Re.b)(e).entities.validationData})]}return[]}const ke="iccrossword";function*Pe(e){const t=yield Object(p.c)(I.getItemDataByIds,{ids:e.data.map(e=>e.id)}),a=Oe.b.setUserData(e),r=[];return e.data.forEach(({id:a,value:i})=>{const s=t.find(e=>e.id===a),c=i.split("");s.cells.forEach((t,a)=>{c[a].trim()&&!r.find(({id:e})=>e===t)&&r.push({id:t,activityId:e.activityId,value:c[a]})})}),r.length&&a.push(le.setCellsUserData({data:Object(v.b)(r).entities.userData})),a}function*_e(e){try{const t=yield Object(p.c)(I.getItemDataByIds,e),a=yield Object(p.c)(W.getUserDataByIds,e),r=t.map(({id:e})=>e),i=[];let s=[];const c=[],n=[];return yield*t.map((function*(e){var t;const i=yield Object(p.c)(H,{cells:e.cells});let l=null===(t=a.find(({id:t})=>t===e.id))||void 0===t?void 0:t.value.split("");if(i.map(e=>e.words).flat().every(e=>r.includes(e)))c.push(e.id),s=[...s,...e.cells];else{var o;const t=i.filter(e=>e.words.every(e=>r.includes(e)));s=[...s,...t.map(({id:e})=>e)],null!==(o=l)&&void 0!==o&&o.length&&(l=l.map((e,a)=>t.includes(i[a])?" ":e).join(""),l.trim()?n.push({id:e.id,activityId:e.activityId,value:l}):(c.push(e.id),s=[...s,...e.cells]))}})),c.length&&i.push(oe.a.clearUserData({activityType:ke,data:c})),n.length&&i.push(oe.a.setUserData({activityType:ke,data:Object(v.b)(n).entities.userData})),s.length&&i.push(le.clearCellsUserData({data:[...new Set(s)]})),i}catch(e){throw new Error(e.message)}}var Ne=a(46);function*qe(e){const t=yield ge.b.setEnabled(e),a=yield Ve(e);return t.concat(a)}function*Be(e){const t=yield ge.b.setDataType(e),a=yield Ve(e);return t.concat(a)}function*Le(e){const t=yield ge.b.setValidationType(e),a=yield Ve(e);return t.concat(a)}function*$e(e){const t=yield ge.b.setBatchUI(e),a=yield Ve(e);return t.concat(a)}const ze=(e,t)=>e.words.every(e=>t.includes(e)),Fe=(e,t,a)=>e.words.filter(({id:e})=>!t.includes(e)).map(e=>a.find(t=>t.id===e));function*Ve(e){let{activityId:t,ids:a,data:r,enabled:i,validationType:s,dataType:c,extra:n}=e;r=r||{enabled:i,validationType:s,dataType:c,extra:n};const l=yield function*(e){return(yield Object(p.c)(I.getItemDataByIds,{ids:e.ids})).map(({cells:e})=>e).flat()}(e),o=yield Object(p.c)(Ne.getActivityUIData,{activityId:t}),d=[];return yield*l.map((function*(e){const i=yield Object(p.c)($,{id:e});let s={};void 0!==r.enabled&&(s=Object.assign(s,((e,t,a,r)=>{const i={},s=Fe(t,a,r);return(!e||ze(t,a)||s.every(t=>t.enabled===e))&&(i.enabled=e),i})(r.enabled,i,a,o))),void 0!==r.dataType&&(s=Object.assign(s,((e,t,a,r)=>{const i={},s=Fe(t,a,r);return("solution"===e||ze(t,a)||s.every(t=>t.dataType===e))&&(i.dataType=e),i})(r.dataType,i,a,o))),d.push({...s,id:e,activityId:t})})),[le.setCellUIData({data:d})]}var Me=a(27),Ge=a(69),He=a(73),We=a(40);const Ke=(e,t)=>t.activityId,Je=(e,t)=>t.words,Ye=m()([He.a],e=>{if(e)return e.metadata.colSize})(Ke),Qe=m()([He.a],e=>{if(e)return e.metadata.rowSize})(Ke),Xe=m()([I.getActivityItemData,(e,t)=>t.align],(e,t)=>{if(e&&t)return e.filter(e=>e.align===t)})(Ke,{selectorCreator:f.a}),Ze=m()([I.getActivityItemData,Ne.getActivityUIDataDataTypeSolution,W.getActivityUserData],(e,t,a)=>{if(!e||!t||!a)return;const r=t.map(({id:t})=>e[t]).filter(Boolean),i=[...new Set(r.flatMap(e=>e.cells))];return e.filter(e=>{const t=a.find(t=>t.id===e.id);if(!t||!t.value.trim())return;return t.value.split("").filter((t,a)=>i.includes(e.cells[a])||t.trim()).length===e.cells.length})})(Ke,{selectorCreator:f.a}),et=m()([W.getActivityUserData,Ze],(e,t)=>{if(e&&t)return t.map(({id:t})=>e.find(e=>e.id===t))})(Ke,{selectorCreator:f.a}),tt=m()([W.getActivityUserData,Je],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(Ke,{selectorCreator:f.a}),at=m()([Ne.getActivityUIData,Je],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(Ke,{selectorCreator:f.a}),rt=m()([We.getActivityValidationData,Je],(e,t)=>{if(e&&t)return e.filter(e=>t.includes(e.id))})(Ke,{selectorCreator:f.a});var it=({activityType:e,activityId:t})=>{Object(u.a)(e)||(Object(Ie.c)("addActivities","iccrossword",xe),Object(Ie.c)("removeActivities","iccrossword",Te),Object(Ce.b)("validate","iccrossword",Ue),Object(Oe.c)("setUserData","iccrossword",Pe),Object(Oe.c)("clearUserData","iccrossword",_e),Object(ge.c)("setEnabled","iccrossword",qe),Object(ge.c)("setDataType","iccrossword",Be),Object(ge.c)("setValidationType","iccrossword",Le),Object(ge.c)("setBatchUI","iccrossword",$e),Object(Me.a)("getActivityItemDataFilteredByFilled","iccrossword",Ze),Object(Ge.a)("getActivityUserDataFilled","iccrossword",et),Object(u.b)({activityType:e,saga:me,reducer:ne})),Object(o.c)(d.b.READY,{type:e,id:t})};const st=(e,t)=>t.screenId,ct=m()([e=>e.screens,st],(e,t)=>{if(e&&t)return e[t.toString()]})(st);var nt=a(24),lt=a(77),ot=a.n(lt),dt=a(54);const ut=Object(nt.createSelector)([e=>e.lo],e=>e.options),yt=(m()([ut,dt.b,dt.a],(e,t,a)=>{if(!e||!t||!a)return;const{loOption:r,option:i}=yt(e,t,a);return i?r?r.value||r.key:i.values[0].key:void 0})(dt.a),m()([ut,dt.b,dt.a],(e,t,a)=>{if(!e||!t||!a)return;const{loOption:r,option:i}=yt(e,t,a);return i?r?r.key:i.values[0].key:void 0})(dt.a),(e,t,a)=>{const r=t.find(e=>ot()(e.name)===ot()(a)),i=e.get(r.id.toString());return{option:r,loOption:i}});a(227),a(228);const pt=Object(nt.createSelector)([ct],e=>e.options),vt=m()([pt,ut,dt.b,dt.a],(e,t,a,r)=>{if(!(e&&t&&a&&r))return;const{screenOption:i,loOption:s,option:c}=mt(e,t,a,r);return c?i?i.value||i.key:s?s.value||s.key:c.values[0].key:void 0})(dt.a),bt=m()([pt,ut,dt.b,dt.a],(e,t,a,r)=>{if(!(e&&t&&a&&r))return;const{screenOption:i,loOption:s,option:c}=mt(e,t,a,r);return c?i?i.key:s?s.key:c.values[0].key:void 0})(dt.a),mt=(e,t,a,r)=>{const i=a.find(e=>ot()(e.name)===ot()(r)),s=t[i.id.toString()],c=e[i.id.toString()];return{option:i,loOption:s,screenOption:c}},ft=(e,t)=>"lower"===bt(e,t,"case"),It=(e,t)=>"pause"===bt(e,t,"audioIconBehaviour"),Ct=(e,t)=>"on"===bt(e,t,"cluesInColumns"),Ot=(e,t)=>"on"===bt(e,t,"audioSpeed"),gt=(e,t)=>vt(e,t,"mediaPlaybackLimit");var wt=a(190),ht=a.n(wt),Dt=a(204);const jt=DPReactComponents.components.activities.ICCrossword.ICCrossword,Et=DPReactComponents.components.activities.ICCrossword.ICCrosswordGrid,xt=DPReactComponents.components.activities.ICCrossword.ICCrosswordRow,Tt=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellInput,St=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellClue,Rt=DPReactComponents.components.activities.ICCrossword.ICCrosswordCellInvisible,At=DPReactComponents.components.activities.ICCrossword.ICCrosswordClue,Ut=DPReactComponents.components.activities.ICCrossword.ICCrosswordClueList,kt=DPReactComponents.components.activities.ICCrossword.ICCrosswordClues,Pt=DPReactComponents.components.activities.ICCrossword.ICCrosswordClueInCell,_t=i.a.createContext({focusedIndex:0});_t.displayName="ICCrosswordUserDataContext";const Nt=i.a.createContext({});Nt.displayName="ICCrosswordFocusContext";const qt=i.a.createContext({});qt.displayName="ICCrosswordHighlightContext";const Bt=e=>e.iccrossword_cells_solutionData,Lt=(e,t)=>t.id,$t=(e,t)=>t.activityId,zt=Object(f.a)([Bt],e=>{if(e)return Object.values(e)}),Ft=(m()([zt,$t],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})($t,{selectorCreator:f.a}),m()([Bt,Lt],(e,t)=>{if(t&&e)return e[t]})(Lt)),Vt=m()([Ft,U],(e,t)=>{if(e&&t&&"user"!==t)return e.value})(Lt),Mt=e=>e.iccrossword_cells_userData,Gt=(e,t)=>t.activityId,Ht=(e,t)=>t.id,Wt=Object(f.a)([Mt],e=>{if(e)return Object.values(e)}),Kt=(m()([Wt,Gt],(e,t)=>{if(e&&t)return e.filter(e=>e.activityId===t)})(Gt,{selectorCreator:f.a}),m()([Mt,Ht],(e,t)=>{if(e&&t)return e[t]})(Ht)),Jt=m()([Kt],e=>{if(e)return e.value})(Ht),Yt=e=>{var t;const{id:a,x:s,y:c,label:n,lowercase:l,solutionDataValue:o,userDataValue:d,uiData:u,words:y,wordsUIData:p,wordsValidationData:v,wordsUserData:b}=e,m=Object(r.useContext)(_t),f=Object(r.useContext)(Nt),I=Object(r.useContext)(qt),[C,O]=Object(r.useState)([]),[g,w]=Object(r.useState)(),[D,j]=Object(r.useState)(),E="solution"===u.dataType?o:d;Object(r.useEffect)(()=>{w(null),j(null);const e=y.map(e=>{const{cells:t,label:r,align:i}=e,n=e.id,l=h(e,{x:s,y:c}),o=v.find(e=>e.id===n),d=p.find(e=>e.id===n),y=b.find(e=>e.id===n),m={relativePosition:l,orientation:"v"===i?"vertical":"horizontal",wordLabel:r,userWord:null==y?void 0:y.value,length:t.length,position:t.indexOf(a),classes:(null==d?void 0:d.extra)||[]};if(null!=d&&d.validationType){let e=!1;if(null!=o&&o.hasOwnProperty("correct")&&null!=o&&o.filled&&(m.isCorrect=o.correct,e=!0),"correct_incorrect_empty"===(null==d?void 0:d.validationType)&&null!=o&&o.hasOwnProperty("filled")&&(m.isFilled=o.filled,e=!0),e){const e=m.isCorrect||"solution"!==u.dataType?void 0:m.userWord,t={correct:!0===m.isCorrect,wrong:!1===m.isCorrect,revealed:void 0===m.isCorrect,tooltip:e,classNames:[m.orientation]};"v"===i?j(t):w(t)}}return m});O(e)},[y,v,u]);const x=null===(t=I.highlighted)||void 0===t?void 0:t.includes(a),T=f.focusedCellId===a,S=x&&I.highlighted.includes(f.focusedCellId);return i.a.createElement(Tt,{letter:E,enabled:u.enabled,label:n,lowercase:l,focused:T,highlighted:x,focusedAndHighlightedRow:S,orientations:C,horizontalCheckmark:g&&i.a.createElement(Dt.a,{correct:g.correct,wrong:g.wrong,revealed:g.revealed,tooltip:g.tooltip,classNames:g.classNames}),verticalCheckmark:D&&i.a.createElement(Dt.a,{correct:D.correct,wrong:D.wrong,revealed:D.revealed,tooltip:D.tooltip,classNames:D.classNames}),onKey:e=>{m.cellKeyEvt(a,e.type,e.keyCode,e.key),f.cellKeyEvt(a,e.type,e.keyCode,e.shiftKey)},onFocus:()=>{f.cellFocusEvt(a)},customEvents:[{name:"specialchars:inserted",callback:e=>{m.cellChangeEvt(a,e.value),f.cellChangeEvt(a)}}]})};Yt.propTypes={id:c.a.string,lowercase:c.a.bool,solutionDataValue:c.a.string,userDataValue:c.a.string,uiData:c.a.shape({id:c.a.string,enabled:c.a.bool,dataType:c.a.string}),words:c.a.arrayOf(c.a.shape({id:c.a.string,label:c.a.number})),wordsUIData:c.a.arrayOf(c.a.shape({id:c.a.string,validationType:c.a.string,extra:c.a.array})),wordsValidationData:c.a.arrayOf(c.a.shape({id:c.a.string,correct:c.a.bool,filled:c.a.bool})),wordsUserData:c.a.arrayOf(c.a.shape({id:c.a.string,value:c.a.string}))};var Qt=Object(n.connect)((e,t)=>({solutionDataValue:Vt(e,t),userDataValue:Jt(e,t),uiData:A(e,t),words:M(e,t),wordsUserData:tt(e,t),wordsValidationData:rt(e,t),wordsUIData:at(e,t),lowercase:ft(e,t)}))(Yt),Xt=a(257),Zt=a.n(Xt);const ea=e=>e._,ta=e=>e.$||{},aa=e=>e["#name"],ra=(e,t)=>{if((e=>"__text__"===e["#name"])(e))return t({text:ea(e)});ta(e);const a=(e=>e.$$||[])(e).map(e=>ra(e,t));return t({tag:aa(e),attrs:ta(e),children:a})},ia=DPReactComponents.components.general.Audio.TinyAudioPlayer,sa=({title:e,mediaRef:t,hasPauseBehaviour:a,hasSpeed:s,persistVolume:c,preloadAuto:n,playedFullyLimit:l,style:o})=>{const[d,u]=Object(r.useState)(!1),[y,p]=Object(r.useState)(!0),[v,b]=Object(r.useState)(0),[m,f]=Object(r.useState)(!1),[I,C]=Object(r.useState)(!1),[O,g]=Object(r.useState)(null),[w,h]=Object(r.useState)(!1),[D,j]=Object(r.useState)(0),[E,x]=Object(r.useState)(0),T=Object(r.useRef)(),S=l,R=!!l,A=a5.dp.config.audioTinyPlayerPlayspeedButton,U=()=>{x(T.current.position())},k=()=>{U(),clearInterval(O),g(null)};Object(r.useEffect)(()=>()=>clearInterval(O),[O]),Object(r.useEffect)(()=>{a5.service.media.audio.bind("ready",()=>{T.current=a5.service.media.audio.create(t,{preload:n}),n&&T.current.load(),p(!1)})},[]);const P=Object(r.useCallback)(()=>{h(!0),j(T.current.duration())},[]),_=Object(r.useCallback)(()=>{u(!1),k()},[]),N=Object(r.useCallback)(()=>{a5.service.media.pauseAll({except:T.current}),u(!0),(()=>{const e=setInterval(U,100);g(e)})()},[]),q=Object(r.useCallback)(()=>{R&&b(e=>e+1),k(),x(0)},[]);Object(r.useEffect)(()=>(T.current.bind("paused",_),T.current.bind("stopped",_),T.current.bind("start",N),T.current.bind("ended",q),T.current.bind("loadprogress",P),()=>{T.current.unbind("paused",_),T.current.unbind("stopped",_),T.current.unbind("start",N),T.current.unbind("ended",q),T.current.unbind("loadprogress",P)}),[P,q,N,_]),Object(r.useEffect)(()=>{v>=S&&(T.current.disable(),f(!0))},[v]),Object(r.useEffect)(()=>{I?T.current.rate(A):T.current.rate(1)},[I]);return i.a.createElement(ia,{playing:d,loading:y,disabled:m,title:e,playbacks:v,limit:S,showLimit:R,speedEnabled:I,hasSpeed:s,hasPauseBehaviour:a,onPlayClick:()=>{d?a?T.current.pause():T.current.stop():T.current.play()},onSpeedClick:()=>{C(!I)},current:E,duration:D})};sa.propTypes={title:c.a.string,mediaRef:c.a.string.isRequired,hasPauseBehaviour:c.a.bool,hasSpeed:c.a.bool,persistVolume:c.a.bool,preloadAuto:c.a.bool,playedFullyLimit:c.a.number,style:c.a.string};var ca=sa;const na=({id:e,data:t,style:a,playerType:r="tinyPlayer",mediaPlaybackLimit:s,audioIconBehaviourIsPause:c,audioSpeedIsOn:n,screenId:l})=>{const o={mediaRef:t,playedFullyLimit:parseInt(s,10),hasSpeed:n,hasPauseBehaviour:c};return{tinyPlayer:i.a.createElement(ca,o),fullPlayer:i.a.createElement("span",null,"TODO: Implement React Full Player"),nativePlayer:i.a.createElement("span",null,"TODO: Implement React Native Player")}[r]};na.propTypes={id:c.a.string.isRequired,data:c.a.string.isRequired,style:c.a.string,playerType:c.a.oneOf(["tinyPlayer","fullPlayer","nativePlayer"]).isRequired,screenId:c.a.number};var la=Object(n.connect)((e,t)=>({mediaPlaybackLimit:gt(e,t),audioIconBehaviourIsPause:It(e,t),audioSpeedIsOn:Ot(e,t)}))(na);const oa=e=>{const{tag:t}=e,a=t;return i.a.createElement(a,e)};oa.propTypes={tag:c.a.string.isRequired};var da=oa;const ua=DPReactComponents.components.general.Image,ya=({id:e,src:t,alt:a,class:s,style:c,"data-hotspots":n})=>{const[l,o]=Object(r.useState)(!1);return i.a.createElement(ua,{id:e,src:A5.ASSET_URL_BUILDER(t),alt:a,classes:s,style:c,expanded:l,onExpandClick:()=>{o(!l)}})};ya.propTypes={id:c.a.string.isRequired,src:c.a.string.isRequired,alt:c.a.string,class:c.a.string,style:c.a.object,"data-hotspots":c.a.string};var pa=ya;const va=DPReactComponents.components.general.Text,ba=({text:e})=>i.a.createElement(va,{text:e});ba.propTypes={text:c.a.string.required};var ma=ba;const fa=({xml:e,screenId:t})=>{const a=({tag:e,attrs:a,children:r,text:s})=>{if(s)return i.a.createElement(ma,{text:s,screenId:t});if("root"===e)return i.a.createElement(i.a.Fragment,null,r);let c;switch(e){case"object":c=la;break;case"img":c=pa;break;default:c=da}const n={tag:e,...a,style:(l=a.style,"string"==typeof l?l.split(";").reduce((e,t)=>{const a=t.indexOf(":");if(-1===a)return e;const r=t.slice(0,a).trim().replace(/-./g,e=>e.slice(1).toUpperCase()),i=t.slice(a+1).trim();return i?{...e,[r]:i}:e},{}):{}),screenId:t,children:r};var l;return i.a.createElement(c,n)},[s,c]=Object(r.useState)();return Object(r.useEffect)(()=>{(async()=>{const t=await(async e=>{const t=new Zt.a.Parser({charsAsChildren:!0,explicitChildren:!0,preserveChildrenOrder:!0,explicitRoot:!1,normalizeTags:!0,normalize:!0});return await t.parseStringPromise(e)})(e);c(t)})()},[e]),s?((e,t)=>ra(e,t))(s,a):null};fa.propTypes={xml:c.a.string.required,screenId:c.a.number};var Ia=fa;const Ca=({clue:e,screenId:t})=>i.a.createElement(Ia,{xml:`<root>${e.join("")}</root>`,screenId:t});Ca.propTypes={clue:c.a.array.isRequired,screenId:c.a.number};var Oa=Ca;const ga=({itemData:e,screenId:t})=>{var a,s;const c=t=>e.find(e=>e.align===t),n=Object(r.useContext)(qt);return i.a.createElement(St,{horizontalId:null===(a=c("h"))||void 0===a?void 0:a.id,verticalId:null===(s=c("v"))||void 0===s?void 0:s.id,onMouseOver:()=>{n.mouseOverEvent(e.map(({id:e})=>e))},onMouseOut:()=>{n.mouseOutEvent()}},e.map(e=>i.a.createElement(Pt,{key:e.id,clue:e.clue,active:!1,orientation:"h"===e.align?"horizontal":"vertical"},i.a.createElement(Oa,{id:e.id,clue:e.clue,screenId:t}))))};ga.propTypes={index:c.a.number,itemData:c.a.arrayOf(c.a.shape({id:c.a.string,cells:c.a.array,align:c.a.string}))};var wa=Object(n.connect)((e,t)=>({itemData:M(e,t)}))(ga);const ha=({cells:e,activityId:t,screenId:a})=>{const r=e.map(e=>e.words.length?"clue"===e.type?i.a.createElement(wa,ht()({key:e.id},e,{screenId:a,activityId:t})):i.a.createElement(Qt,ht()({key:e.id},e,{screenId:a,activityId:t})):i.a.createElement(Rt,{key:e.id}));return i.a.createElement(xt,null,r)};ha.propTypes={cells:c.a.array.isRequired,activityId:c.a.string.isRequired,screenId:c.a.number.isRequired};var Da=Object(n.connect)((e,t)=>({cells:V(e,t)}))(ha);const ja=({rows:e,cols:t,activityId:a,screenId:r})=>{const s=Array.from({length:e},(e,s)=>i.a.createElement(Da,{key:s,index:s,cols:t,activityId:a,screenId:r}));return i.a.createElement(Et,null,s)};ja.propTypes={rows:c.a.number.isRequired,cols:c.a.number.isRequired,activityId:c.a.string.isRequired,screenId:c.a.number.isRequired};var Ea=ja;const xa=({label:e,clue:t,id:a,screenId:s,cells:c})=>{const n=Object(r.useContext)(qt),l=Object(r.useContext)(Nt),o=c.includes(l.focusedCellId);return i.a.createElement(At,{label:e,onMouseOver:()=>n.mouseOverEvent([a]),onMouseOut:()=>n.mouseOutEvent(),isCluesCellFocused:o},i.a.createElement(Oa,{id:a,clue:t,screenId:s}))};xa.propTypes={label:c.a.number.isRequired,clue:c.a.arrayOf(c.a.string).isRequired,id:c.a.string.isRequired,screenId:c.a.number,cells:c.a.arrayOf(c.a.string)};var Ta=xa;const Sa=({align:e,clues:t,screenId:a})=>{const r=t.map(e=>i.a.createElement(Ta,ht()({key:e.id},e,{screenId:a})));return i.a.createElement(Ut,{orientation:"v"===e?"vertical":"horizontal"},r)};Sa.propTypes={align:c.a.string,clues:c.a.array,screenId:c.a.number};var Ra=Object(n.connect)((e,t)=>({clues:Xe(e,t)}))(Sa);const Aa=({activityId:e,screenId:t,cluesInColumns:a})=>i.a.createElement(kt,{cluesInColumn:a},["h","v"].map((a,r)=>i.a.createElement(Ra,{key:r,align:a,activityId:e,screenId:t})));Aa.propTypes={activityId:c.a.string,screenId:c.a.number,cluesInColumns:c.a.bool};var Ua=Aa;const ka=({words:e,children:t})=>{const[a,s]=Object(r.useState)([]),[c,n]=Object(r.useState)([]);return i.a.createElement(qt.Provider,{value:{highlighted:a,highlightedWords:c,mouseOverEvent:t=>{s(e.filter(({id:e})=>t.includes(e)).map(({cells:e})=>e).flat()),n(t)},mouseOutEvent:()=>{s([]),n([])}}},t)};ka.propTypes={words:c.a.array.isRequired,children:c.a.node};var Pa=Object(n.connect)((e,t)=>({words:Object(I.getActivityItemData)(e,t)}))(ka);const _a={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DASH:45,DELETE:46,COMMA:188,PERIOD:190,NUMERIC:[...Array(10).keys()].map(e=>e+48),CAPITAL_LETTERS:[...Array(26).keys()].map(e=>e+65),LETTERS:[...Array(26).keys()].map(e=>e+97),NON_ENGLISH_RANGE:{low:128,high:1273}},Na=e=>e===_a.BACKSPACE,qa=e=>e===_a.DASH||_a.NUMERIC.includes(e)||_a.CAPITAL_LETTERS.includes(e)||_a.LETTERS.includes(e)||e>=_a.NON_ENGLISH_RANGE.low&&e<=_a.NON_ENGLISH_RANGE.high,Ba=({setUserData:e,removeUserData:t,children:a})=>i.a.createElement(_t.Provider,{value:{cellKeyEvt:(a,r,i,s)=>{if("keydown"===r){let r;qa(i)?r=s:Na(i)&&(r=""),void 0!==r&&(r?e({id:a,value:r}):t({id:a}))}},cellChangeEvt:(a,r)=>{r?e({id:a,value:r}):t({id:a})}}},a);Ba.propTypes={setUserData:c.a.func.isRequired,removeUserData:c.a.func.isRequired,children:c.a.object};var La=Object(n.connect)(null,(e,t)=>({setUserData:a=>e(fe.setCellUserData({...a,activityId:t.activityId})),removeUserData:t=>e(fe.clearCellUserData({...t,data:[t.id]}))}))(Ba),$a=a(283),za=a.n($a),Fa=a(330),Va=a.n(Fa);const Ma=({editableCells:e,editableWords:t,rowSize:a,colSize:s,children:c})=>{const[n,l]=Object(r.useState)(),[o,d]=Object(r.useState)(),u=({x:t,y:a})=>e.find(e=>e.x===t&&e.y===a),y=t=>t.cells.map(t=>e.find(e=>e.id===t)).filter(Boolean),p=e=>za()(e.words.map(e=>t.find(t=>t.id===e)).filter(Boolean),"align"),v=za()(t,"align"),b=(e,t,a)=>{let r=e,i=((e,t,a)=>{if(e.cells.includes(t.id)){const r=y(e);let i=Va()(r,e=>e.id===t.id)+a;return i<0||i>=r.length?null:r[i]}})(e,t,a);if(!i){const t=Va()(v,t=>t.id===e.id);r=v[(t+v.length+a)%v.length];const s=y(r);i=s[1===a?0:s.length-1]}return[i,r]},m=(e,t)=>{let r,i;if(c=t,[_a.LEFT,_a.UP,_a.RIGHT,_a.DOWN].includes(c)){let c=0,n=0;switch(t){case _a.UP:n=-1;break;case _a.DOWN:n=1;break;case _a.LEFT:c=-1;break;case _a.RIGHT:c=1}r=(({xStep:e,yStep:t},r)=>{let i,c=r.x,n=r.y;do{if(c+=e,n+=t,i=u({x:c,y:n}),i){r=i;break}}while(c>=0&&c<=a&&n>=0&&n<=s);return r})({xStep:c,yStep:n},e),r&&(i=p(r)[0])}var c;return[r,i]},f=(e,t,a,r)=>{let i,s;const c=Na(a),n=qa(a),l=a===_a.TAB;if(c||n||l){let a=c||l&&r?-1:1;[i,s]=b(t,e,a)}return[i,s]},I=Object(r.useCallback)((e,t,a,r)=>{let i,s,[c,n]=g(e);"keyup"===t?[i,s]=m(c,a):"keydown"===t&&([i,s]=f(c,n,a,r)),i&&s&&w(i,s)}),C=Object(r.useCallback)(e=>{let[t,a]=g(e),[r,i]=b(a,t,1);r&&i&&w(r,i)}),O=Object(r.useCallback)(t=>{if(t!==o){const a=e.find(e=>e.id===t);w(a,p(a)[0])}}),g=a=>{let r,i;return a===o?(i=e.find(e=>e.id===o),r=t.find(e=>e.id===n),r=r||p(i)[0]):(i=e.find(e=>e.id===a),r=p(i)[0]),[i,r]},w=(e,t)=>{d(e.id),l(t.id)};return Object(r.useEffect)(()=>{if(e.length&&!e.find(({id:e})=>e===o)){const t=e[0],a=p(t)[0];l(null==a?void 0:a.id),d(null==t?void 0:t.id)}},[e,o]),i.a.createElement(Nt.Provider,{value:{focusedCellId:o,cellKeyEvt:I,cellFocusEvt:O,cellChangeEvt:C}},c)};Ma.propTypes={rowSize:c.a.number.isRequired,colSize:c.a.number.isRequired,editableCells:c.a.array.isRequired,editableWords:c.a.array.isRequired,children:c.a.node};var Ga=Object(n.connect)((e,t)=>({editableCells:z(e,t),editableWords:G(e,t)}))(Ma);const Ha=({activityId:e,visible:t,cluesAreInside:a=!1,cluesInColumns:r,screenId:s,colSize:c,rowSize:n,transactions:l})=>i.a.createElement(i.a.Fragment,null,!l.length&&t&&i.a.createElement(Ga,{activityId:e,screenId:s,rowSize:n,colSize:c},i.a.createElement(La,{activityId:e,screenId:s},i.a.createElement(Pa,{activityId:e,screenId:s},i.a.createElement(jt,null,i.a.createElement(Ea,{activityId:e,screenId:s,cols:c,rows:n}),!a&&i.a.createElement(Ua,{activityId:e,screenId:s,cluesInColumns:r}))))));Ha.propTypes={activityId:c.a.string.isRequired,visible:c.a.bool,cluesAreInside:c.a.bool,cluesInColumns:c.a.bool.isRequired,screenId:c.a.number.isRequired,colSize:c.a.number,rowSize:c.a.number,transactions:c.a.array};t.default=Object(l.a)(Object(n.connect)((e,t)=>({cluesInColumns:Ct(e,t),colSize:Ye(e,t),rowSize:Qe(e,t),transactions:Object(He.b)(e,t)}),null)(Ha),it)}}]);